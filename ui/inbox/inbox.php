<div class="subheader subheader-transparent" id="kt_subheader">
    <div class="container-fluid d-flex align-items-center justify-content-between flex-wrap flex-sm-nowrap">
        <div class="d-flex align-items-center flex-wrap mr-1">
            <div class="d-flex align-items-baseline flex-wrap mr-5">

                <div class="d-flex flex-column text-dark-75">
                    <h2 class="text-dark font-weight-bolder mr-5 line-height-xl">
                    <span class="svg-icon svg-icon-xxl mr-1">
						<!--begin::Svg Icon | path:assets/media/svg/icons/Design/Layers.svg-->
						<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
                            <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                <rect x="0" y="0" width="24" height="24"/>
                                <path d="M22,15 L22,19 C22,20.1045695 21.1045695,21 20,21 L4,21 C2.8954305,21 2,20.1045695 2,19 L2,15 L6.27924078,15 L6.82339262,16.6324555 C7.09562072,17.4491398 7.8598984,18 8.72075922,18 L15.381966,18 C16.1395101,18 16.8320364,17.5719952 17.1708204,16.8944272 L18.118034,15 L22,15 Z" fill="#000000"/>
                                <path d="M2.5625,13 L5.92654389,7.01947752 C6.2807805,6.38972356 6.94714834,6 7.66969497,6 L16.330305,6 C17.0528517,6 17.7192195,6.38972356 18.0734561,7.01947752 L21.4375,13 L18.118034,13 C17.3604899,13 16.6679636,13.4280048 16.3291796,14.1055728 L15.381966,16 L8.72075922,16 L8.17660738,14.3675445 C7.90437928,13.5508602 7.1401016,13 6.27924078,13 L2.5625,13 Z" fill="#000000" opacity="0.3"/>
                            </g>
                        </svg>
                        <!--end::Svg Icon-->
					</span>
                        Inbox</h2>
                    <span class="font-weight-normal font-size-h6 ml-12">All your communication in one place</span>
                </div>
            </div>
        </div>
        <div class="d-flex align-items-center">

        </div>
    </div>
</div>

<div class="d-flex flex-column-fluid pt-7">

    <div class="container-fluid">

        <div class="d-flex flex-row">


            <div class="flex-row-auto offcanvas-mobile w-200px w-xxl-275px" id="kt_inbox_aside">

                <div class="card card-custom card-stretch menu-card" data-type="">

                    <div class="card-body px-5">

                        <div class="px-4 mt-4 mb-10">
                            <a href="#" class="btn btn-block btn-primary font-weight-bold text-uppercase py-4 px-6 text-center" data-toggle="modal" data-target="#kt_inbox_compose">New Message</a>
                        </div>
                        <div class="navi navi-hover navi-active navi-link-rounded navi-bold navi-icon-center navi-light-icon">
                            
                            <div class="navi-item my-2">
                                <a href="#" id='inbox' class="navi-link active">
                                    <span class="navi-icon mr-4">
                                    <span class="svg-icon svg-icon-lg">

                                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
                                    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                    <rect x="0" y="0" width="24" height="24"></rect>
                                    <path d="M6,2 L18,2 C18.5522847,2 19,2.44771525 19,3 L19,13 C19,13.5522847 18.5522847,14 18,14 L6,14 C5.44771525,14 5,13.5522847 5,13 L5,3 C5,2.44771525 5.44771525,2 6,2 Z M13.8,4 C13.1562,4 12.4033,4.72985286 12,5.2 C11.5967,4.72985286 10.8438,4 10.2,4 C9.0604,4 8.4,4.88887193 8.4,6.02016349 C8.4,7.27338783 9.6,8.6 12,10 C14.4,8.6 15.6,7.3 15.6,6.1 C15.6,4.96870845 14.9396,4 13.8,4 Z" fill="#000000" opacity="0.3"></path>
                                    <path d="M3.79274528,6.57253826 L12,12.5 L20.2072547,6.57253826 C20.4311176,6.4108595 20.7436609,6.46126971 20.9053396,6.68513259 C20.9668779,6.77033951 21,6.87277228 21,6.97787787 L21,17 C21,18.1045695 20.1045695,19 19,19 L5,19 C3.8954305,19 3,18.1045695 3,17 L3,6.97787787 C3,6.70173549 3.22385763,6.47787787 3.5,6.47787787 C3.60510559,6.47787787 3.70753836,6.51099993 3.79274528,6.57253826 Z" fill="#000000"></path>
                                    </g>
                                    </svg>

                                    </span>
                                    </span>
                                    <span class="navi-text font-weight-bolder font-size-lg">Inbox</span>
                                    <span class="navi-label">
                                        <span class="label label-rounded label-light-success font-weight-bolder">
                                            
                                        </span>
                                    </span>
                                </a>
                            </div>

                            <div class="navi-item my-2">
                                <a href="#" class="navi-link" id='sent'>
                                    <span class="navi-icon mr-4">
                                    <span class="svg-icon svg-icon-lg">

                                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
                                        <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                            <rect x="0" y="0" width="24" height="24"></rect>
                                            <path d="M8,13.1668961 L20.4470385,11.9999863 L8,10.8330764 L8,5.77181995 C8,5.70108058 8.01501031,5.63114635 8.04403925,5.56663761 C8.15735832,5.31481744 8.45336217,5.20254012 8.70518234,5.31585919 L22.545552,11.5440255 C22.6569791,11.5941677 22.7461882,11.6833768 22.7963304,11.794804 C22.9096495,12.0466241 22.7973722,12.342628 22.545552,12.455947 L8.70518234,18.6841134 C8.64067359,18.7131423 8.57073936,18.7281526 8.5,18.7281526 C8.22385763,18.7281526 8,18.504295 8,18.2281526 L8,13.1668961 Z" fill="#000000"></path>
                                            <path d="M4,16 L5,16 C5.55228475,16 6,16.4477153 6,17 C6,17.5522847 5.55228475,18 5,18 L4,18 C3.44771525,18 3,17.5522847 3,17 C3,16.4477153 3.44771525,16 4,16 Z M1,11 L5,11 C5.55228475,11 6,11.4477153 6,12 C6,12.5522847 5.55228475,13 5,13 L1,13 C0.44771525,13 6.76353751e-17,12.5522847 0,12 C-6.76353751e-17,11.4477153 0.44771525,11 1,11 Z M4,6 L5,6 C5.55228475,6 6,6.44771525 6,7 C6,7.55228475 5.55228475,8 5,8 L4,8 C3.44771525,8 3,7.55228475 3,7 C3,6.44771525 3.44771525,6 4,6 Z" fill="#000000" opacity="0.3"></path>
                                            </g>
                                    </svg>

                                    </span>
                                    </span>
                                    <span class="navi-text font-weight-bolder font-size-lg">Sent</span>
                                    <span class="navi-label">
                                        <span class="label label-rounded label-light-success font-weight-bolder">
                                            
                                        </span>
                                    </span>
                                    </a>
                            </div>

                            <div class="navi-item my-2">
                                <a href="#" class="navi-link" id="mark" >
                                    <span class="navi-icon mr-4">
                                    <span class="svg-icon svg-icon-lg">

                                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
                                    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                    <polygon points="0 0 24 0 24 24 0 24"></polygon>
                                    <path d="M12,4.25932872 C12.1488635,4.25921584 12.3000368,4.29247316 12.4425657,4.36281539 C12.6397783,4.46014562 12.7994058,4.61977315 12.8967361,4.81698575 L14.9389263,8.95491503 L19.5054023,9.61846284 C20.0519472,9.69788046 20.4306287,10.2053233 20.351211,10.7518682 C20.3195865,10.9695052 20.2170993,11.1706476 20.0596157,11.3241562 L16.7552826,14.545085 L17.5353298,19.0931094 C17.6286908,19.6374458 17.263103,20.1544017 16.7187666,20.2477627 C16.5020089,20.2849396 16.2790408,20.2496249 16.0843804,20.1472858 L12,18 L12,4.25932872 Z" fill="#000000" opacity="0.3"></path>
                                    <path d="M12,4.25932872 L12,18 L7.91561963,20.1472858 C7.42677504,20.4042866 6.82214789,20.2163401 6.56514708,19.7274955 C6.46280801,19.5328351 6.42749334,19.309867 6.46467018,19.0931094 L7.24471742,14.545085 L3.94038429,11.3241562 C3.54490071,10.938655 3.5368084,10.3055417 3.92230962,9.91005817 C4.07581822,9.75257453 4.27696063,9.65008735 4.49459766,9.61846284 L9.06107374,8.95491503 L11.1032639,4.81698575 C11.277344,4.464261 11.6315987,4.25960807 12,4.25932872 Z" fill="#000000"></path>
                                    </g>
                                    </svg>

                                    </span>
                                    </span>
                                    <span class="navi-text font-weight-bolder font-size-lg">Marked</span>
                                    <span class="navi-label">
                                        <span class="label label-rounded label-light-success font-weight-bolder">
                                            
                                        </span>
                                    </span>
                                    </a>
                            </div>

                            <div class="navi-item my-2">
                                
                                <a href="#" id="trash" class="navi-link">
                                    <span class="navi-icon mr-4">
                                    <span class="svg-icon svg-icon-lg">

                                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
                                    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                    <rect x="0" y="0" width="24" height="24"></rect>
                                    <path d="M6,8 L6,20.5 C6,21.3284271 6.67157288,22 7.5,22 L16.5,22 C17.3284271,22 18,21.3284271 18,20.5 L18,8 L6,8 Z" fill="#000000" fill-rule="nonzero"></path>
                                    <path d="M14,4.5 L14,4 C14,3.44771525 13.5522847,3 13,3 L11,3 C10.4477153,3 10,3.44771525 10,4 L10,4.5 L5.5,4.5 C5.22385763,4.5 5,4.72385763 5,5 L5,5.5 C5,5.77614237 5.22385763,6 5.5,6 L18.5,6 C18.7761424,6 19,5.77614237 19,5.5 L19,5 C19,4.72385763 18.7761424,4.5 18.5,4.5 L14,4.5 Z" fill="#000000" opacity="0.3"></path>
                                    </g>
                                    </svg>

                                    </span>
                                    </span>
                                    <span class="navi-text font-weight-bolder font-size-lg">Trash</span>
                                    <span class="navi-label">
                                        <span class="label label-rounded label-light-success font-weight-bolder"
                                        ></span>
                                    </span>
                                </a>
                            </div>


                            <div class="navi-item my-10"></div>


                            <div class="navi-item my-2">
                                <!-- <a href="#" class="navi-link">
                                    <span class="navi-icon mr-4">
                                    <i class="fa fa-genderless text-danger"></i>
                                    </span>
                                    <span class="navi-text">Custom Work</span>
                                    <span class="navi-label">
                                    <span class="label label-rounded label-light-danger font-weight-bolder">6</span>
                                    </span>
                                </a> -->
                            </div>


                            <div class="navi-item my-2">
                                <!-- <a href="#" class="navi-link">
                                    <span class="navi-icon mr-4">
                                    <i class="fa fa-genderless text-success"></i>
                                    </span>
                                    <span class="navi-text">Partnership</span>
                                </a> -->
                            </div>


                            <div class="navi-item my-2">
                                <!-- <a href="#" class="navi-link">
                                    <span class="navi-icon mr-4">
                                    <i class="fa fa-genderless text-info"></i>
                                    </span>
                                    <span class="navi-text">In Progres</span>
                                </a> -->
                            </div>


                            <div class="navi-item my-2">
                                <!-- <a href="#" class="navi-link">
                                    <span class="navi-icon mr-4">
                                    <i class="fa flaticon2-plus icon-1x"></i>
                                    </span>
                                    <span class="navi-text">Add Label</span>
                                </a> -->
                            </div>

                        </div>

                    </div>

                </div>

            </div>


            <div class="flex-row-fluid ml-lg-8 d-block" id="kt_inbox_list" data-type="" data-page="">

                
            </div>


            <div class="flex-row-fluid ml-lg-8 d-none" id="kt_inbox_view">

                

            </div>

        </div>


        <div class="modal modal-sticky modal-sticky-lg modal-sticky-bottom-right" id="kt_inbox_compose" role="dialog" data-backdrop="false">
            <div class="modal-dialog" role="document">
                <div class="modal-content">

                    <form id="kt_inbox_compose_form">

                        <div class="d-flex align-items-center justify-content-between py-5 pl-8 pr-5 border-bottom">
                            <h5 class="font-weight-bold m-0">Compose</h5>
                            <div class="d-flex ml-2">
                                <span class="btn btn-clean btn-sm btn-icon mr-2">
                                <i class="flaticon2-arrow-1 icon-1x"></i>
                                </span>
                                <span class="btn btn-clean btn-sm btn-icon" data-dismiss="modal">
                                <i class="ki ki-close icon-1x"></i>
                                </span>
                            </div>
                        </div>


                        <div class="d-block">

                            <div class="d-flex align-items-center border-bottom inbox-to px-8 min-h-45px">
                                <div class="text-dark-50 w-75px">To:</div>
                                <div class="d-flex align-items-center flex-grow-1">
                                    <input type="text" class="form-control border-0" name="compose_to" value="">
                                </div>
                                <div class="ml-2">
                                    <span class="text-muted font-weight-bold cursor-pointer text-hover-primary mr-2" data-inbox="cc-show">Cc</span>
                                    <span class="text-muted font-weight-bold cursor-pointer text-hover-primary" data-inbox="bcc-show">Bcc</span>
                                </div>
                            </div>


                            <div class="d-none align-items-center border-bottom inbox-to-cc pl-8 pr-5 min-h-45px">
                                <div class="text-dark-50 w-75px">Cc:</div>
                                <div class="flex-grow-1">
                                    <tags class="tagify  form-control border-0" tabindex="-1">
                                        <span contenteditable="" data-placeholder="​" aria-placeholder="" class="tagify__input" role="textbox" aria-autocomplete="both" aria-multiline="false"></span>
                                    </tags><input type="text" class="form-control border-0" name="compose_cc" value="">
                                </div>
                                <span class="btn btn-clean btn-xs btn-icon" data-inbox="cc-hide">
                                <i class="la la-close"></i>
                                </span>
                            </div>


                            <div class="d-none align-items-center border-bottom inbox-to-bcc pl-8 pr-5 min-h-45px">
                                <div class="text-dark-50 w-75px">Bcc:</div>
                                <div class="flex-grow-1">
                                    <tags class="tagify  form-control border-0" tabindex="-1">
                                        <span contenteditable="" data-placeholder="​" aria-placeholder="" class="tagify__input" role="textbox" aria-autocomplete="both" aria-multiline="false"></span>
                                    </tags><input type="text" class="form-control border-0" name="compose_bcc" value="">
                                </div>
                                <span class="btn btn-clean btn-xs btn-icon" data-inbox="bcc-hide">
                                <i class="la la-close"></i>
                                </span>
                            </div>


                            <div class="border-bottom">
                                <input class="form-control border-0 px-8 min-h-45px" name="compose_subject" placeholder="Subject">
                            </div>

                            <textarea id='content' name='compose_content' style="display: none;"></textarea>
                            <div id="kt_inbox_compose_editor" class="border-0 ql-container ql-snow" style="height: 250px">
                                
                            </div>
                            
                            <div class="dropzone dropzone-multi px-8 py-4" id="kt_inbox_compose_attachments">
                                <div class="dropzone-items">

                                </div>
                                <div class="dz-default dz-message">
                                    <button class="dz-button" type="button">Drop files here to upload</button>
                                </div>
                            </div>

                        </div>


                        <div class="d-flex align-items-center justify-content-between py-5 pl-8 pr-5 border-top">

                            <div class="d-flex align-items-center mr-3">

                                <div class="btn-group mr-4">
                                    <span id="message_send" class="btn btn-primary font-weight-bold px-6">Send</span>
                                    <span class="btn btn-primary font-weight-bold dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" role="button"></span>
                                    <div class="dropdown-menu dropdown-menu-sm dropup p-0 m-0 dropdown-menu-right">
                                        <ul class="navi py-3">
                                            <li class="navi-item">
                                                <a href="#" class="navi-link">
                                                    <span class="navi-icon">
                                                    <i class="flaticon2-writing"></i>
                                                    </span>
                                                    <span class="navi-text">Schedule Send</span>
                                                </a>
                                            </li>
                                            <li class="navi-item">
                                                <a href="#" class="navi-link">
                                                    <span class="navi-icon">
                                                    <i class="flaticon2-medical-records"></i>
                                                    </span>
                                                    <span class="navi-text">Save &amp; archive</span>
                                                </a>
                                            </li>
                                            <li class="navi-item">
                                                <a href="#" class="navi-link">
                                                    <span class="navi-icon">
                                                    <i class="flaticon2-hourglass-1"></i>
                                                    </span>
                                                    <span class="navi-text">Cancel</span>
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>


                                <span class="btn btn-icon btn-sm btn-clean mr-2 dz-clickable" id="kt_inbox_compose_attachments_select">
                                <i class="flaticon2-clip-symbol"></i>
                                </span>
                                <span class="btn btn-icon btn-sm btn-clean">
                                <i class="flaticon2-pin"></i>
                                </span>

                            </div>


                            <div class="d-flex align-items-center">
                                <span class="btn btn-icon btn-sm btn-clean mr-2" data-toggle="tooltip" title="" data-original-title="More actions">
                                    <i class="flaticon2-settings"></i>
                                </span>
                                <!-- <span class="btn btn-icon btn-sm btn-clean" data-inbox="dismiss" data-toggle="tooltip" title="" data-original-title="Dismiss reply">
                                    <i class="flaticon2-rubbish-bin-delete-button"></i>
                                </span> -->
                            </div>

                        </div>

                    </form>

                </div>
            </div>
        </div>

    </div>

</div>
<script>  
          
    var host="<?php echo $rootDomain;?>";
         
    $('#kt_inbox_aside a').on('click',function()
    {
        $("#kt_inbox_aside a.active").removeClass("active");
        
        $(this).addClass("active");
        var type = $(this).attr("id");

        
        if(type =='trash')
            WebApp.loadPartialPage('#kt_inbox_list', 'inbox/trash',fnCallbackLoadMessage);
        else if(type =='sent')
            WebApp.loadPartialPage('#kt_inbox_list', 'inbox/sent',fnCallbackLoadMessage);
        else if (type =='inbox')
            WebApp.loadPartialPage('#kt_inbox_list', 'inbox/list',fnCallbackLoadMessage);
        else if (type =='mark')
            WebApp.loadPartialPage('#kt_inbox_list', 'inbox/getMark',fnCallbackLoadMessage);
    });

    
    $(document).on("click","#kt_inbox_list .card-header .page-move",function()
    {
        
        var type = $('#kt_inbox_list').attr("data-type");
        var current_page = $('#kt_inbox_list .card-header .current_page').val();
        
        var move_type =  $(this).attr("data-type");
        
        var new_page;
        if(move_type =='prev_page')
        {    
            if(current_page > 0)
                new_page = parseInt(current_page) - 1 ;
            else
                new_page = parseInt(current_page);
        }
        else if(move_type =='next_page')
            new_page = parseInt(current_page) + 1 ;
        
        if(type =='trash')
            WebApp.loadPartialPage('#kt_inbox_list', 'inbox/trash'+new_page,fnCallbackLoadMessage);
        else if(type =='sent')
            WebApp.loadPartialPage('#kt_inbox_list', 'inbox/sent'+new_page,fnCallbackLoadMessage);
        else if (type =='inbox')
            WebApp.loadPartialPage('#kt_inbox_list', 'inbox/list/'+new_page,fnCallbackLoadMessage);
        else if (type =='mark')
            WebApp.loadPartialPage('#kt_inbox_list', 'inbox/getMark'+new_page,fnCallbackLoadMessage);
    });

</script>
<script src="/assets/js/inbox/inbox.js"></script>
<script>

    $(document).on("click","#kt_inbox_list .list-item .detail-view",function()
    {
        var id = ($(this).parent().parent().attr("id")).substr(8);

        
        var current_page = $('#kt_inbox_list .card-header .current_page').val();

        $('#kt_inbox_list').attr("data-page",current_page);
        
        WebApp.loadPartialPage('#kt_inbox_list', 'inbox/view/'+id,fnCallbackViewMessage);
    });
    function fnCallbackViewMessage(webResponse)
    {
        
        if(webResponse.errorCode == 0)
        {

                        
        }
    }

   

    $('#message_send').on('click',()=>
    {
        
        var html = $('#kt_inbox_compose_form .ql-editor').html();
        $("#content").html(html);
        WebApp.postForm('#kt_inbox_compose_form', 'inbox/post', fnCallbackPostMessage);
    })
    function fnCallbackPostMessage(webResponse)
    {
        
        if(webResponse.errorCode == 0)
        {

            $("#kt_inbox_compose").modal('hide');
            WebApp.loadPage('inbox');
            
        }
    }
    WebApp.loadPartialPage('#kt_inbox_list', 'inbox/list',fnCallbackLoadMessage);
    function fnCallbackLoadMessage(webResponse)
    {
        if(webResponse.errorCode == 0)
        {
            var response = webResponse.message.split("_");
            $('#kt_inbox_aside a#'+response[1]+' span.label-light-success').text(response[0]);
            $('#kt_inbox_list').attr("data-type",response[1]);

        }
    }
</script>